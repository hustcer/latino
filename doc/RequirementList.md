# 需求规则描述：

**【该规则描述仅供参考，以实际逻辑为准】**

## 前台功能描述：
* 报名页要实时显示当前开课班级及相关信息:已报名人数(报名通过，等待审核)，剩余可报名名额等。
* 如果当前无可开课班级则直接将报名显示为更新用户个人信息或者注册之类
* 对于未注册、从来没有报过名的同学可以在报名页面输入个人信息，选择相应课程进行报名：报名信息包括工号、选择报名班级、姓名、性别、邮箱、旺旺、分机、支付宝、部门；其中工号在数据库中是唯一的可以作为用户的标识。
* 如果之前已经报过名、系统里面有培训记录，但是本期没有报名的话，当其输入个人工号，在blur的时候，系统会根据工号去后台查询相应的个人信息填充在报名表单里面，这样用户不用重复输入，但是可以报名相应课程或者更改个人信息，保存到数据库。
* 报名只是发出一个报名申请，新报名的课程处于等待管理员审核状态（除非系统自动将其审核通过）。
* 如果用户已经报名过当前开课课程，数据库中有记录，当其输入个人工号blur的时候：
    * 系统会显示他已经报名的课程，该课程被check上，并且disable掉，如果报名的课程正在审核中则提示等待审核；
    * 如果审核不通过则提示报名失败，课程被disable掉，但是没有被check上，报名失败后相应失败的课程不可重新发出报名申请；
    * 如果审核通过报名成功则会在后面加一个申请退课按钮，用户可以提交退课申请，等待管理员审批，审批通过逻辑：
        * 如果用户未交费则直接修改课程状态为退课；
        * 如果用户已缴费则先线下退费再修改退课状态。

* 通常会有多个班开课，如果其中一个课程已经报名则已报名课程走上面报名逻辑，如果还有一个课程未报名，并且还有名额则可以申请报名。
* 可以查看所有已报名会员个人信息，包括历来所有参加的培训课程，也可以修改个人信息，目前不加权限控制，所以也可以修改其他人信息，只要知道工号。

* 在报名情况查询页用户可以以列表形式看到当前课程的报名信息：所有的报名会员相关信息，课程状态、付费状态等等。
* 该列表可以分页、排序。
* 可以进行筛选查询：可以根据工号、性别、历次培训课程、付费状态、课程状态、部门等条件进行任意组合筛选。查询结果通过ajax请求返回，无刷新显示。
* 可以方便地通过渲染markdown文档方式显示系统更新日志及其他信息

## 后台功能描述：
* 管理员可以将课程报名审核通过（只有会员课程处于waiting状态时方才有效）、
* 将退课申请审核通过（只有会员课程处于quitApplied状态时方才有效）、
* 修改会员缴费状态（只有会员课程处于quitApplied状态时方能设置为未交费，只有当课程处于approved状态时才能设为已缴费）、
* 修改会员其他信息包括vip属性、level等。
* 如果是vip会员、或者level高于某个值的会员，其报名的课程不用审核直接通过。
* 可以有黑名单，该名单里的会员不能申请任何一次课程报名。

### [MISC] Untracked But CLOSED Issue List

- 全局
    * 【H】UI设计及完善
    * 【H】浏览器兼容性调整，html5 shive支持，IE8以下版本浏览器给于升级提示 
    * 【H】通过include 或者layout 实现模板代码公用，方便维护       
    * 【H】不同舞种数据存储在不同的Collecion中 
    * 【M】快速、批量生成测试数据，初始化数据库                               
    * 【H】Production mode/ development mode 路由处理/权限控制 
    * 【M】错误提示或者无权限页面：404
    * 【H】各舞种开课班级配置文件合并：具体开课班级列表、课程相应参数分开定义 
    * 【H】当前开课班级配置成数组，各个班级配置参数可以分开设置，也可以采用全局默认设置
    * 【H】Markdown File Render Support ----------Very Important !!!                                      

- 报名页                    
    * 【H】从课程配置文件里面读取当前开课课程详细信息、系统公告等，并初始化设置
    * 【H】报名统计信息、限额、报名成功人数等 
    * 【H】首页统计信息采用异步回调方式改善页面加载速度
    * 【M】课程报名锁定：Lock则报名结束  
    * 【H】报名信息表单：工号、姓名、性别、邮箱、旺旺、分机、部门等
    * 【H】输入工号焦点移除后通过Ajax请求查询用户填充数据并填充表单
    * 【H】根据用户当前课程报名状态给予相应提示;设置在当前状态下可执行的操作:报名/取消报名/申请退课？
    * 【M】email中'@alibaba-inc'  trim处理                                              
    * 【M】工号大小写统一转换为大写，保持数据库中工号唯一性
    * 【M】性别确定后不能修改 
    * 【H】表单前后台验证（目前前台验证已处理，后台验证暂时不予支持）  
    * 【M】重置表单按钮相关逻辑                                          
    * 【M】申请报名后自助放弃/取消报名  
    * 【H】用户报名审核通过后可以自助申请退课，不过需要管理员审核                           
    * 【M】课程状态转换有时间记录 用于确定用户报名先后顺序       
    * 【L】申请退课后自助放弃退课-----X (尽量降低复杂度，减少用户随意操作的可能性)
    * 【M】记录会员报名时间  
    * 【H】报名自动审批，根据等级、vip、序号、性别自动审批                                   
    * 【L】报名信息提交后自动刷新统计信息
    * 【L】报名信息提交成功后给予相应提示，可以给出个人信息查看链接                                   

- 报名信息筛选查询页
    * 【H】课程查询输出结果过滤，支持各种条件组合查询  
    * 【H】筛选条件面包屑: 可以清除某一个筛选条件，也可以清除所有筛选条件 
    * 【M】默认查询当前开课课程且报名成功的会员 
    * 【M】查询结果输出信息格式化
    * 【H】查询结果分页                              
    * 【H】查询结果表头排序 ：支持按 工号、姓名、性别、邮箱、旺旺、分机、部门 进行排序
    * 【L】工号链接到相应的个人信息页
    * 【L】表头排序状态指示标志                           
    * 【H】List查询页第一次请求通过Ajax获取数据，保持逻辑一致   
    * 【M】List查询页加载loading提示  
    * 【M】导出满足相应条件的邮件列表 

- 个人信息展示页
    * 显示用户个人信息：工号、姓名、性别、邮箱、旺旺、分机、部门、参与的培训课程等

- 后台管理员
    * 【H】后台管理员报名审核功能                                        
    * 【H】后台管理员退课审核通过 
    * 【M】后台管理员退课审核拒绝   
    * 【H】后台管理员设置缴费  
    * 【M】审核退课的时候检查下是否已经退费 
    * 【M】后台管理员操作提示文案完善    
    * 【H】后台管理员修改用户所有信息操作 
    * 【H】管理员对会员报名状态进行操作的时候都要进行校验、确保满足前置条件


